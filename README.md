# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/main.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Интернет-магазин «Web-Larёk»
«Web-Larёk» — это интернет-магазин с товарами для веб-разработчиков, где пользователи могут просматривать товары, добавлять их в корзину и оформлять заказы. Сайт предоставляет удобный интерфейс с модальными окнами для просмотра деталей товаров, управления корзиной и выбора способа оплаты, обеспечивая полный цикл покупки с отправкой заказов на сервер.

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP (Model-View-Presenter), которая обеспечивает четкое разделение ответственности между классами слоев Model и View. Каждый слой несет свой смысл и ответственность:

Model - слой данных, отвечает за хранение и изменение данных.  
View - слой представления, отвечает за отображение данных на странице.  
Presenter - презентер содержит основную логику приложения и  отвечает за связь представления и данных.

Взаимодействие между классами обеспечивается использованием событийно-ориентированного подхода. Модели и Представления генерируют события при изменении данных или взаимодействии пользователя с приложением, а Презентер обрабатывает эти события используя методы как Моделей, так и Представлений.

### Базовый код

#### Класс Component
Является базовым классом для всех компонентов интерфейса.
Класс является дженериком и принимает в переменной `T` тип данных, которые могут быть переданы в метод `render` для отображения.

Конструктор:  
`constructor(container: HTMLElement)` - принимает ссылку на DOM элемент за отображение, которого он отвечает.

Поля класса:  
`container: HTMLElement` - поле для хранения корневого DOM элемента компонента.

Методы класса:  
`render(data?: Partial<T>): HTMLElement` - Главный метод класса. Он принимает данные, которые необходимо отобразить в интерфейсе, записывает эти данные в поля класса и возвращает ссылку на DOM-элемент. Предполагается, что в классах, которые будут наследоваться от `Component` будут реализованы сеттеры для полей с данными, которые будут вызываться в момент вызова `render` и записывать данные в необходимые DOM элементы.  
`setImage(element: HTMLImageElement, src: string, alt?: string): void` - утилитарный метод для модификации DOM-элементов `<img>`


#### Класс Api
Содержит в себе базовую логику отправки запросов.

Конструктор:  
`constructor(baseUrl: string, options: RequestInit = {})` - В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.

Поля класса:  
`baseUrl: string` - базовый адрес сервера  
`options: RequestInit` - объект с заголовками, которые будут использованы для запросов.

Методы:  
`get(uri: string): Promise<object>` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер  
`post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.  
`handleResponse(response: Response): Promise<object>` - защищенный метод проверяющий ответ сервера на корректность и возвращающий объект с данными полученный от сервера или отклоненный промис, в случае некорректных данных.

#### Класс EventEmitter
Брокер событий реализует паттерн "Наблюдатель", позволяющий отправлять события и подписываться на события, происходящие в системе. Класс используется для связи слоя данных и представления.

Конструктор класса не принимает параметров.

Поля класса:  
`_events: Map<string | RegExp, Set<Function>>)` -  хранит коллекцию подписок на события. Ключи коллекции - названия событий или регулярное выражение, значения - коллекция функций обработчиков, которые будут вызваны при срабатывании события.

Методы класса:  
`on<T extends object>(event: EventName, callback: (data: T) => void): void` - подписка на событие, принимает название события и функцию обработчик.  
`emit<T extends object>(event: string, data?: T): void` - инициализация события. При вызове события в метод передается название события и объект с данными, который будет использован как аргумент для вызова обработчика.  
`trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие с передачей в него данных из второго параметра.

### Данные 

Раздел представляет информацию об интерфейсах моделей данных, которые отражены на сайте. Главная страница сайта содержит каталог товаров, каждый из которых имеет четкую структуру данных, которой они должны соответствовать. 

Интерфейс IProduct.
Одна из сущностей, оторая описывает данные - это товар: id в виде строки, title (название) - строка, image (картинка) - строка с адресом изображения, category (категория) - строка, группа товаров, к которой относится один из них, price (цена) - число, равное стоимости покупки или null - бесценный продукт, который не имеет стоимости покупки, а также description (описание товара) - подробная информация для ознакомления. Данный набор характеристик представлен в интерфейсе товара IProduct. 

Интерфейс IBuyer.
При дальнейшей оформлении выбранных товаров из корзины пользователь имеет возможность заполнить данные, неоходимые для заказа: payment (оплата) - выбор между оплатой картой и наличными, помимо этого интерфейс предлагает отсутсвие выбора, address (адресс доставки) - строка, email - строка, phone (номер телефона) в виде строки. Перечисленные характеристики отражены в интерфейсе IBuyer.

#### Класс "ItemsCatalog" каталог товаров

Назначение: Данный класс направлен на управление и корректое отображение каталога товаров, возможных для покупки, а также выбранного товара для более подробного изучения. 

Конструктор: Конструктор класса принимает список товаров для вывода в качесве каталога. Он создает пустой массив товаров и сбрасывает выбор карточки. 

`constructor(items: IProduct[] = []) `

Поля класса: 

`protected items: IProduct[]` - отображение массива товаров в каталоге

`protected selectedItem: IProduct | null` - выбранная пользователем карточка либо ее отсутствие

Методы класса: 

`setItems(items: IProduct[]): void` - устанавливает масссив товаров для каталога

`getItems(): IProduct[]` - получает список товаров

`getItemByID(id: string): IProduct | undefined` - получает товар по id

`saveSelectedItem(selectedItem: IProduct): void` - сохраняет выбранную карточку для подробного изображения

`getSelectedItem(): IProduct | null` - возвращает выбранную карточку при ее наличии


### Класс "Cart" корзина

Назначение: Данный класс реализует функцию представления массива товаров, выбранных пользователем. Система реализует также возможности добавления товара, его удаления, подсчета количества товаров, выведения списка товаров, сумму стоимости товаров, а также уточнение наличия товара. 

Конструктор: В констуктор принимает массив выбранных пользователем товаров

`construct(selectedItems: IProduct[] = [])` 

Поля: 

`selectedItems: IProduct[]` - хранит массив товаров, выбранных пользователем для покупки

Методы: 

`getItemsCart(): IProduct[]` - возвращает товары из корзины

`addItemCart(item: IProduct): void` - добавление товара в корзину

`removeItemCart(id: string): void` - удаление товара из корзины

`clearCart():void` - очищает корзину

`getTotalPrice(): number` - получение стоимости всех товаров в корзине

`getItemsAmount(): number` - получение количества товаров в корзине 

`wheterItem(id:string): boolean` - проверка на наличие товара в корзине 



### Класс Buyer 

Назначение: Функциональность класса направлена на работу - проверку, получения и сохранение - с данными о покупателе, включающих способ оплаты, адресс, email, номер телефона.

Конструктор: 

`constructor(dataBuyer: IBuyer)` - в конструктор передаются данные типа интерфейс IBuyer

Поля: 

`payment: 'card' | 'cash' | ''` - способ оплаты: по карте, наличными или не выбранный

`address: string` - адрес 

`email: string` - email

`phone: string` - номер телефона 


Методы: 

`saveData(dataBuyer: Partial<IBuyer>): void` - сохранение данных о покупателе

`getData(): IBuyer` - получение всех данных о пользователе

`clearData(): void` - очищение всех данных о пользователе

`validateData(): boolean` - проверка на корректность данных о пользователе



## Cлой коммуникации

### Класс apiCommunication

Назначение: Класс выполняет с помощью get запросы на сервер для получения объекта с массивами данных и с помощью post данные направлять.

Кнструктор: 

`constructor(api: IApi)` - принимает объект коммуникации с сервером

Поля: 

`api: IApi`

Методы: 

`getItems(): Promise<IProduct[]>` - получает промис со списком товаров в сервера 

`postItems(order: IOrder): Promise<IOrderResult>` - отправляет товар на сервер и получает промис с результатом


## Слой View 

Слой представления в данном проекте реализует отображение данных для пользоваеля, а также помогает пользователю при взаимодействии с интерфейсом. Общий родитель классов слоя - Component<T>, от которого наследуются компоненты и утилиты.

<!-- ### Класс Page

Назначение: Данный класс отвечает за отображение страницы при открытиии модальных окон. 

Конструктор: constructor(container: HTMLElement) 

Поля: 

`content: HTMLElement` - основной контент страницы
`locked: boolean` - возможна ли прокрутка на странице

Методы: 

`locked(boolean): void` - блокирует / снимает блокировку на странице при открытии модального окна

`render(data ? void): HTMLElement` - возращает корневой элемент страницы -->

### Класс ModelDialog

Данный класс реализует модальное окно: его открытие, закрытие различными способами и содержимое. 

Конструктор: 

`constructor(HTMLElement)` - принимает контейнер (DOM-element)

Поля: 

`content: HTMLElement` - контейнер для содержимого 
`closeButton(HTMLButtonElement)` - кнопка для закрытия модального окна
`ifOpen: boolean` - состояние модального окна

Методы: 
`open(node: HTMLElement):void` - октрывает модальное окно и представляет переданную информацию
`close():void` - закрывает модальное окно
`withClose(handler: () => void): void` - обработчик при закрытии модального окна

### Класс Header 

Назначение: Header страницы, содрежащий логотип с надписью и корзину со счетчиком товаров в ней. 

Конструктор: `constructor(container: HTMLElement)`

Поля: 

`cartCount: HTMLElement` - количество товаров в коризне 

Методы: 

`setCartCount(count: number): void` — сеттер устанавливает количество товаров  в корзине
`onCartClick(handler: () => void): void` — обработчик при клике на корзину 

### Класс Gallery 

Назначение: Представление каталога товаров на сайте

Конструктор: `constructor(container: HTMLElement)` - принимает контейнер для контента

Поля: 

`products: HTMLElement[]` - принимает массив карточек - товаров

Методы: 

`setItems(nodes: HTMLElement[]): void` - устанавливает список карточек 

`clear(): void` - очищает списко товаров со страницы

### Класс BasicCard (общий)

НАзначение: Класс является общим для трех дочерних классов карточек. 

Конструктор: `constructor(container: HTMLElement)`

Поля: 
`id: string` - идентификатор картчоки товара
`titleItem: HTMLElement` - название товара
`price: HTMLElement` - цена товара 

Методы: 

`setId(id: string): void` - устанавливает идентификатор
`setTitle(title: string): void` - устанаваливает имя карточки 
`setPrice(price: number|null): void` - устанавливает цену или при ее отсутсвии - "бесценно"
`onClick(handler: (id: string) => void): void` — обработчик события при клике по карточке



#### Класс GalleryCard extends BasicCard

Назначение: Класс отвечает за отображение карточки в галерее на сайте 

Kонстурктор: `constructor(container: HTMLElement)`

Дополнительные Поля: 

`imageItem: HTMLImageElement` - изображение карточки товара
`categoryItem: HTMLElement` - категория товара

Дополнительные Методы: 

`setImage(src: string, alt?: string): void` - устанавливает изображение 
`setCategory(category: string): void` - устанавливает категорию
`render(data: ICard): HTMLElement` - генерирует данные товаров



#### Класс PreviewCard extends BasicCard

Назначение: детальное описание карточки с изменением содержимого кнопки в зависимости от наличия в корзине выбранного товара. 

Дополнительные Поля: 

`imageItem: HTMLImageElement` - изображение карточки товара
`categoryItem: HTMLElement` - категория товара
`description: MLElement` - подробное описание товара
`inCart: boolean` - прверяет,находится ли товар в корзине, что влияет на отображение кнопки на сайте
`ifZero: boolean` - проверяет, не является ли товар бесценым, чтобы сделать покупку невозможной

Дополнительные Методы: 

`setImage(src: string, alt?: string): void` - устанавливает изображение 
`setCategory(category: string): void` - устанавливает категорию
`setDescription(description: string): void` - устанавливается описание 
`onAddToCart(handler: (id: string) => void): void` - обработчик события при клике по кнопке "купить"

#### Класс CartCard extends BasicCard

Назначение: отображение информации о карточке в списке товаров из корзины

Дополнительные Поля: 

`indexCard: number` - порядковый номер товара в корзине
`buttonDeleteItemFromCard: HTMLButtonElement` - возможность удалить товар из коризны

Дополнительные Методы: 

`setIndex(value: number): void` - устанавливает порядковый номер для списка товаров
`removeFromCart(handler: (id: string) => void): void)` - по клику на кнопку удаляет товар из корзины

### Класс CartView

Назначение: отображение корины товаров с возможностью перейти на этап оформления заказа. 

Конструктор: `constructor(container: HTMLElement, eventBroker: IEvent)`

Поля: 

`items: HTMLElement[]` - список товаров, добавленных в коризну 
`totalPrice: number` - итоговая стоимость товаров
`orderButton: HTMLButtonElement` - кнопка для  оформления  заказа

Методы: 

`setItems(items: HTMLElement[])` - устанавливает список выбранный товаров для корзины
`setTotalPrice(total: number): void` - отвечает за отображение итоговой стоимости товаров
`onSubmitOrder(handler: () => void): void` - генерирует событие при клике на "Оформить"

### Класс BasicForm (общий)

Назначение: Отображение формы заказа в модальном окне, соблюдающие общие для двух дочрних паттерны. 

Конструктор: `constructor(container: HTMLElement)`

Поля: 

`SubmitButton: HTMLButtonElement` - кнопка, которая на различных этапах оформления имеет описание "Далее" / "Оплатить"

`errors: string` - строка с описанием ошибок при заполнении пользователем формы

Методы: 

`disableButton(state: boolean): void` - блокирует кнопку
`setErrors(errors: Partial<Record<keyof T, string>>): void` - показывает отдельно ошибки в полях
`onSubmitButton(handler: () => void): void` - генерирует событие при клике на конопку при оформлении


#### Класс AddressForm extends BasicForm

Назначение: Предоставление выбора способа оплаты из двух вариантов, а также заполнение адреса доставки. 

Конструктор: `constructor(container: HTMLElement`

Поля: 

`paymentInput: 'cash' | 'card' | ''` - активирует способ оплаты
`addressInput: string` - адрес, записанный строкой

Методы: 

`setPayment(value: TPayment): void` - выбор способа оплаты
`setAddress(address: string): void` - адрес строкой


#### Класс PersonalDataForm extends BasicForm

Назначение: Формы для получение email и телефона пользователя. 

Констуктор: `constructor(container: HTMLElement)`

Поля: 

`emailInput: string` - поле для email
`phoneInput: string` - поля для номера телефона

Методы: 

`setEmail(email: string): void)` - ввод email пользователя
`setPhone(phone: string): void)` - ввод номера телефона пользователя


### Класс SuccessForm

Назначение: Информация об успешном оформлении заказа. 

Конструктор: `constructor(container: HTMLElement, eventBroker: IEvent)`

Поля: 

`totalPrice: number` - итоговая стоимость заказа


Методы: 

`setTotalPrice(value: number)` - отображение стоимости заказа

## Слой Презенетер 

В проекте слой Презентер реализует функцию представления 
